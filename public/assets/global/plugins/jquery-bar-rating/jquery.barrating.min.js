(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if(typeof module==="object"&&module.exports){module.exports=a(require("jquery"))}else{a(jQuery)}}}(function(b){var a=(function(){function c(){var w=this;var g=function(){var G=["br-wrapper"];if(w.options.theme!==""){G.push("br-theme-"+w.options.theme)}w.$elem.wrap(b("<div />",{"class":G.join(" ")}))};var m=function(){w.$elem.unwrap()};var A=function(G){if(b.isNumeric(G)){G=Math.floor(G)}return b('option[value="'+G+'"]',w.$elem)};var u=function(){var G=w.options.initialRating;if(!G){return b("option:selected",w.$elem)}return A(G)};var x=function(){var G=w.$elem.find('option[value="'+w.options.emptyValue+'"]');if(!G.length&&w.options.allowEmpty){G=b("<option />",{value:w.options.emptyValue});return G.prependTo(w.$elem)}return G};var v=function(G){var H=w.$elem.data("barrating");if(typeof G!=="undefined"){return H[G]}return H};var j=function(G,H){if(H!==null&&typeof H==="object"){w.$elem.data("barrating",H)}else{w.$elem.data("barrating")[G]=H}};var t=function(){var I=u();var K=x();var J=I.val();var L=I.data("html")?I.data("html"):I.text();var M=(w.options.allowEmpty!==null)?w.options.allowEmpty:!!K.length;var H=(K.length)?K.val():null;var G=(K.length)?K.text():null;j(null,{userOptions:w.options,ratingValue:J,ratingText:L,originalRatingValue:J,originalRatingText:L,allowEmpty:M,emptyRatingValue:H,emptyRatingText:G,readOnly:w.options.readonly,ratingMade:false})};var F=function(){w.$elem.removeData("barrating")};var k=function(){return v("ratingText")};var h=function(){return v("ratingValue")};var o=function(){var G=b("<div />",{"class":"br-widget"});w.$elem.find("option").each(function(){var K,J,H,I;K=b(this).val();if(K!==v("emptyRatingValue")){J=b(this).text();H=b(this).data("html");if(H){J=H}I=b("<a />",{href:"#","data-rating-value":K,"data-rating-text":J,html:(w.options.showValues)?J:""});G.append(I)}});if(w.options.showSelectedRating){G.append(b("<div />",{text:"","class":"br-current-rating"}))}if(w.options.reverse){G.addClass("br-reverse")}if(w.options.readonly){G.addClass("br-readonly")}return G};var y=function(){if(v("userOptions").reverse){return"nextAll"}else{return"prevAll"}};var E=function(G){A(G).prop("selected",true);w.$elem.change()};var r=function(){b("option",w.$elem).prop("selected",function(){return this.defaultSelected});w.$elem.change()};var z=function(G){G=G?G:k();if(G==v("emptyRatingText")){G=""}if(w.options.showSelectedRating){w.$elem.parent().find(".br-current-rating").text(G)}};var l=function(G){return Math.round(((Math.floor(G*10)/10)%1)*100)};var q=function(){w.$widget.find("a").removeClass(function(G,H){return(H.match(/(^|\s)br-\S+/g)||[]).join(" ")})};var D=function(){var J=w.$widget.find('a[data-rating-value="'+h()+'"]');var L=v("userOptions").initialRating;var G=b.isNumeric(h())?h():0;var I=l(L);var H,K;q();J.addClass("br-selected br-current")[y()]().addClass("br-selected");if(!v("ratingMade")&&b.isNumeric(L)){if((L<=G)||!I){return}H=w.$widget.find("a");K=(J.length)?J[(v("userOptions").reverse)?"prev":"next"]():H[(v("userOptions").reverse)?"last":"first"]();K.addClass("br-fractional");K.addClass("br-fractional-"+I)}};var p=function(G){if(!v("allowEmpty")||!v("userOptions").deselectable){return false}return(h()==G.attr("data-rating-value"))};var f=function(G){G.on("click.barrating",function(I){var K=b(this),H=v("userOptions"),J,L;I.preventDefault();J=K.attr("data-rating-value");L=K.attr("data-rating-text");if(p(K)){J=v("emptyRatingValue");L=v("emptyRatingText")}j("ratingValue",J);j("ratingText",L);j("ratingMade",true);E(J);z(L);D();H.onSelect.call(w,h(),k(),I);return false})};var B=function(G){G.on("mouseenter.barrating",function(){var H=b(this);q();H.addClass("br-active")[y()]().addClass("br-active");z(H.attr("data-rating-text"))})};var i=function(G){w.$widget.on("mouseleave.barrating blur.barrating",function(){z();D()})};var n=function(G){G.on("touchstart.barrating",function(H){H.preventDefault();H.stopPropagation();b(this).click()})};var d=function(G){G.on("click.barrating",function(H){H.preventDefault()})};var e=function(G){f(G);if(w.options.hoverState){B(G);i(G)}};var s=function(G){G.off(".barrating")};var C=function(G){var H=w.$widget.find("a");if(n){n(H)}if(G){s(H);d(H)}else{e(H)}};this.show=function(){if(v()){return}g();t();w.$widget=o();w.$widget.insertAfter(w.$elem);D();z();C(w.options.readonly);w.$elem.hide()};this.readonly=function(G){if(typeof G!=="boolean"||v("readOnly")==G){return}C(G);j("readOnly",G);w.$widget.toggleClass("br-readonly")};this.set=function(H){var G=v("userOptions");if(w.$elem.find('option[value="'+H+'"]').length===0){return}j("ratingValue",H);j("ratingText",w.$elem.find('option[value="'+H+'"]').text());j("ratingMade",true);E(h());z(k());D();if(!G.silent){G.onSelect.call(this,h(),k())}};this.clear=function(){var G=v("userOptions");j("ratingValue",v("originalRatingValue"));j("ratingText",v("originalRatingText"));j("ratingMade",false);r();z(k());D();G.onClear.call(this,h(),k())};this.destroy=function(){var H=h();var I=k();var G=v("userOptions");s(w.$widget.find("a"));w.$widget.remove();F();m();w.$elem.show();G.onDestroy.call(this,H,I)}}c.prototype.init=function(d,e){this.$elem=b(e);this.options=b.extend({},b.fn.barrating.defaults,d);return this.options};return c})();b.fn.barrating=function(d,c){return this.each(function(){var e=new a();if(!b(this).is("select")){b.error("Sorry, this plugin only works with select fields.")}if(e.hasOwnProperty(d)){e.init(c,this);if(d==="show"){return e.show(c)}else{if(e.$elem.data("barrating")){e.$widget=b(this).next(".br-widget");return e[d](c)}}}else{if(typeof d==="object"||!d){c=d;e.init(c,this);return e.show()}else{b.error("Method "+d+" does not exist on jQuery.barrating")}}})};b.fn.barrating.defaults={theme:"",initialRating:null,allowEmpty:null,emptyValue:"",showValues:false,showSelectedRating:true,deselectable:true,reverse:false,readonly:false,fastClicks:true,hoverState:true,silent:false,onSelect:function(d,e,c){},onClear:function(c,d){},onDestroy:function(c,d){}};b.fn.barrating.BarRating=a}));